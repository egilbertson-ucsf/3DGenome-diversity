#!/bin/bash
#$ -N get_genotypes
#$ -M colin.brand@ucsf.edu
#$ -m ae
#$ -cwd
#$ -o ~/../../../group/capra/projects/pan_3d_genome/scripts/3_in_silico_mutagenesis/get_genotypes.out
#$ -e ~/../../../group/capra/projects/pan_3d_genome/scripts/3_in_silico_mutagenesis/get_genotypes.err
#$ -l h_rt=24:00:00
#$ -l mem_free=60G

# load modules
module load CBI
module load bcftools

# change directories
cd ../../data/vcfs

# run
#bcftools merge /wynton/group/capra/data/wynton_databases/1000_genomes/release/20190312_biallelic_SNV_and_INDEL/*.phased.vcf.gz -0 -O z -o merged_filtered.vcf.gz --force-samples
#bcftools index -t merged_filtered.vcf.gz
#bcftools query -f '%CHROM\t%POS\t%REF\t%ALT[\t%GT]\n' merged_filtered.vcf.gz > genotypes.txt
#cut -f1,2,3,4,2301,2294,2322,2323,2216,921,707,811,1011,997,1668,1662,1384,1393,1387,95,94,42,93,108,332,647,863,652,645,471,479,509,390,523,1358,1160,1248,1228,1168,157,196,164,161,162,1047,1143,1149,1126,1067,2471,2492,2481,2494,2455,1864,1818,1894,1860,1827,257,271,261,267,242,614,539,615,609,600,1677,1486,1476,1484,1679,1999,1960,1989,2064,2005,798,689,694,822,794,2137,2204,2023,2032,2196,1312,1216,1382,1340,1379,2267,2278,2264,2226,2246,838,734,903,880,894,453,288,420,418,408,1091,1053,1396,1088,1057,1544,1514,1577,1417,1580,2406,2370,2366,2344,2412,2104,2083,2088,2091,2115,1778,1735,1701,1697,1737 genotypes.txt > filtered_genotypes.txt

cut -f1,2,3,4,37,88,89,90,103,152,156,157,159,191,237,252,256,262,266,283,327,385,403,413,415,448,466,474,504,518,534,595,604,609,610,640,642,647,684,689,702,729,789,793,806,817,833,858,875,889,898,916,992,1006,1042,1048,1052,1062,1083,1086,1121,1138,1144,1155,1163,1211,1223,1243,1307,1335,1353,1374,1377,1379,1382,1388,1391,1412,1471,1479,1481,1509,1539,1572,1575,1657,1663,1672,1674,1692,1696,1730,1732,1773,1813,1822,1855,1859,1889,1955,1984,1994,2000,2018,2027,2059,2078,2083,2086,2099,2110,2132,2191,2199,2211,2221,2241,2259,2262,2273,2289,2296,2317,2318,2339,2361,2365,2401,2407,2450,2466,2476,2487,2489 genotypes.txt > filtered_genotypes_new.txt

sed 's|0\|0|0|g; s|0\|1|1|g; s|1\|0|1|g; s|1\|1|1|g' filtered_genotypes.txt > one_zero_genotypes.txt

